<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Click Countryballs: World Edition</title>
    <style>
        :root { --panel: #1e293b; --bg: #020617; --gold: #fbbf24; --green: #22c55e; }
        body {
            margin: 0; display: flex; height: 100vh;
            background: var(--bg); color: white;
            font-family: 'Segoe UI', sans-serif; overflow: hidden; user-select: none;
        }

        .sidebar {
            width: 320px; background: rgba(0,0,0,0.8);
            border-right: 3px solid #334155; padding: 20px;
            display: flex; flex-direction: column; gap: 15px; z-index: 10;
        }
        .main-game {
            flex-grow: 1; display: flex; flex-direction: column;
            align-items: center; justify-content: center; position: relative;
        }

        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
        .ball-container {
            position: relative; width: 280px; height: 280px;
            animation: float 3s ease-in-out infinite;
            transition: transform 0.05s; cursor: pointer;
        }
        .ball-container:active { transform: scale(0.85); animation: none; }
        #country-flag {
            width: 100%; height: 100%; border-radius: 50%;
            border: 8px solid #fff; object-fit: cover;
            box-shadow: 0 0 60px rgba(0,0,0,0.9);
        }

        .eyes { position: absolute; top: 35%; width: 100%; display: flex; justify-content: center; gap: 50px; }
        .eye { width: 45px; height: 55px; background: white; border-radius: 50%; border: 5px solid #000; }

        .card { background: var(--panel); padding: 15px; border-radius: 12px; border: 1px solid #475569; }
        button {
            width: 100%; padding: 12px; border-radius: 8px; border: none;
            background: var(--green); color: white; font-weight: bold; cursor: pointer; margin-top: 8px;
        }
        button:disabled { background: #475569; opacity: 0.5; }
        
        .about-section { font-size: 0.85rem; color: #94a3b8; border-top: 1px solid #334155; padding-top: 10px; margin-top: 10px; }
        .score-area { text-align: center; margin-bottom: 30px; }
        .popup { position: absolute; color: var(--gold); font-weight: 900; pointer-events: none; animation: popGo 0.6s forwards; font-size: 2.2rem; z-index: 500;}
        @keyframes popGo { to { opacity: 0; transform: translateY(-150px) scale(2); } }

        #owner-panel {
            position: absolute; top: 20px; left: 340px; background: #7f1d1d; 
            padding: 15px; border-radius: 10px; display: none; border: 2px solid white; z-index: 100;
        }
    </style>
</head>
<body>

    <div id="owner-panel">
        <strong>OWNER MODS</strong><br>
        <button onclick="cheat(500000)">+500k Bux</button>
        <button onclick="resetAll()" style="background: #000;">Hard Reset</button>
        <button onclick="document.getElementById('owner-panel').style.display='none'">Close</button>
    </div>

    <div class="sidebar">
        <h2 style="margin:0; color:var(--gold)">Market</h2>
        
        <div class="card">
            <strong>Infinite Strength</strong>
            <button id="buy-pwr">Upgrade ($<span id="pwr-cost">15</span>)</button>
        </div>

        <div class="card">
            <strong>Auto-Laborers (+10)</strong>
            <button id="buy-auto">Hire ($<span id="auto-cost">100</span>)</button>
        </div>

        <div class="about-section">
            <strong>About</strong><br>
            A 10 year old named Dalton, created this game as a testing game. But he realised it was good and kept it and made a website..
        </div>
        
        <div style="margin-top:auto">
            <button onclick="resetAll()" style="background: #ef4444;">Delete Progress</button>
        </div>
    </div>

    <div class="main-game">
        <div class="score-area">
            <div id="location-name" onclick="showOwner()" style="font-size: 1.2rem; letter-spacing: 2px; color: #64748b; cursor: help;">STARTING...</div>
            <div style="font-size: 5rem; font-weight: 900; color: var(--gold);" id="score-val">0</div>
            <div style="color: #64748b;">Countrybux</div>
        </div>

        <div class="ball-container" id="ball">
            <img id="country-flag" src="">
            <div class="eyes">
                <div class="eye"></div>
                <div class="eye"></div>
            </div>
        </div>
    </div>

    <script>
        const sfx_click = new Audio('https://www.soundjay.com/buttons/sounds/button-37a.mp3');
        
        let data = { score: 0, power: 1, pwrCost: 15, auto: 0, autoCost: 100 };
        const SAVE_KEY = "dalton_world_save";
        
        // Full Country List Mapping (Code lookup)
        const countryList = [
            "Afghanistan", "Albania", "Algeria", "Andorra", "Angola", "Antigua and Barbuda", "Argentina", "Armenia", "Australia", "Austria", "Azerbaijan", "Bahamas", "Bahrain", "Bangladesh", "Barbados", "Belarus", "Belgium", "Belize", "Benin", "Bolivia", "Bosnia and Herzegovina", "Botswana", "Brazil", "Brunei", "Bulgaria", "Burkina Faso", "Burma", "Burundi", "Cabo Verde", "Cambodia", "Cameroon", "Canada", "Central African Republic", "Chad", "Chile", "China", "Colombia", "Comoros", "Costa Rica", "Croatia", "Cuba", "Cyprus", "Czechia", "Denmark", "Djibouti", "Dominica", "Dominican Republic", "Ecuador", "Egypt", "El Salvador", "Equatorial Guinea", "Eritrea", "Estonia", "Eswatini", "Ethiopia", "Fiji", "Finland", "France", "Gabon", "Gambia", "Georgia", "Germany", "Ghana", "Greece", "Grenada", "Guatemala", "Guinea", "Guinea-Bissau", "Guyana", "Haiti", "Honduras", "Hungary", "Iceland", "India", "Indonesia", "Iran", "Iraq", "Ireland", "Israel", "Italy", "Jamaica", "Japan", "Jordan", "Kazakhstan", "Kenya", "Kiribati", "Korea", "Kosovo", "Kuwait", "Kyrgyzstan", "Laos", "Latvia", "Lebanon", "Lesotho", "Liberia", "Libya", "Liechtenstein", "Lithuania", "Luxembourg", "Madagascar", "Malawi", "Malaysia", "Maldives", "Mali", "Malta", "Marshall Islands", "Mauritania", "Mauritius", "Mexico", "Micronesia", "Moldova", "Monaco", "Mongolia", "Montenegro", "Morocco", "Mozambique", "Namibia", "Nauru", "Nepal", "Netherlands", "New Zealand", "Nicaragua", "Niger", "Nigeria", "Niue", "North Macedonia", "Norway", "Oman", "Pakistan", "Palau", "Panama", "Papua New Guinea", "Paraguay", "Peru", "Philippines", "Poland", "Portugal", "Qatar", "Romania", "Russia", "Rwanda", "Saint Kitts and Nevis", "Saint Lucia", "Samoa", "San Marino", "Saudi Arabia", "Senegal", "Serbia", "Seychelles", "Sierra Leone", "Singapore", "Slovakia", "Slovenia", "Solomon Islands", "Somalia", "South Africa", "South Sudan", "Spain", "Sri Lanka", "Sudan", "Suriname", "Sweden", "Switzerland", "Syria", "Tajikistan", "Tanzania", "Thailand", "Timor-Leste", "Togo", "Tonga", "Trinidad and Tobago", "Tunisia", "Turkey", "Turkmenistan", "Tuvalu", "Uganda", "Ukraine", "United Arab Emirates", "United Kingdom", "Uruguay", "Uzbekistan", "Vanuatu", "Venezuela", "Vietnam", "Yemen", "Zambia", "Zimbabwe"
        ];

        // Function to get flag from RestCountries or Flagpedia based on name
        function getFlagUrl(name) {
            // Special handling for Texas and historical entities can be added here
            if(name === "Texas") return "https://flagpedia.net/data/flags/w580/us-tx.png";
            return `https://countriesnow.space/api/v0.1/countries/flag/images`; // Placeholder logic
        }

        function save() { localStorage.setItem(SAVE_KEY, JSON.stringify(data)); }
        
        function load() {
            const saved = localStorage.getItem(SAVE_KEY);
            if(saved) data = JSON.parse(saved);
            refresh();
        }

        function refresh() {
            document.getElementById('score-val').textContent = Math.floor(data.score).toLocaleString();
            document.getElementById('pwr-cost').textContent = data.pwrCost.toLocaleString();
            document.getElementById('auto-cost').textContent = data.autoCost.toLocaleString();
            document.getElementById('buy-pwr').disabled = data.score < data.pwrCost;
            document.getElementById('buy-auto').disabled = data.score < data.autoCost;

            // Change country every 300 Bux to cycle through the long list faster
            let idx = Math.min(Math.floor(data.score / 300), countryList.length - 1);
            let countryName = countryList[idx];
            document.getElementById('location-name').textContent = countryName.toUpperCase();
            
            // Using a reliable flag CDN by searching for the name
            document.getElementById('country-flag').src = `https://joonsay.com/flags/${countryName.toLowerCase().replace(/ /g, "-")}.png`;
            
            // Fallback for missing flags
            document.getElementById('country-flag').onerror = function() {
                this.src = "https://flagpedia.net/data/flags/w580/un.png"; // UN flag as fallback
            };
        }

        document.getElementById('ball').addEventListener('click', (e) => {
            data.score += data.power;
            try { sfx_click.currentTime = 0; sfx_click.play(); } catch(err){}
            spawnPopup(e.clientX, e.clientY, data.power);
            refresh(); save();
        });

        document.getElementById('buy-pwr').addEventListener('click', () => {
            if(data.score >= data.pwrCost) {
                data.score -= data.pwrCost;
                data.power++;
                data.pwrCost = Math.round(data.pwrCost * 1.5);
                refresh(); save();
            }
        });

        document.getElementById('buy-auto').addEventListener('click', () => {
            if(data.score >= data.autoCost) {
                data.score -= data.autoCost;
                data.auto += 10;
                data.autoCost = Math.round(data.autoCost * 1.7);
                refresh(); save();
            }
        });

        function spawnPopup(x, y, val) {
            const p = document.createElement('div');
            p.className = 'popup';
            p.style.left = x + 'px'; p.style.top = y + 'px';
            p.innerText = `+$${val}`;
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 600);
        }

        setInterval(() => {
            if(data.auto > 0) {
                data.score += (data.auto * data.power) / 5;
                refresh();
            }
        }, 200);

        function showOwner() { document.getElementById('owner-panel').style.display = 'block'; }
        function cheat(n) { data.score += n; refresh(); save(); }
        function resetAll() { if(confirm("Erase all progress?")) { localStorage.clear(); location.reload(); } }

        load();
    </script>
</body>
</html>
