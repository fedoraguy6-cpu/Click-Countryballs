<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Click Countryballs</title>
    <style>
        :root { --sidebar-w: 250px; }
        body {
            margin: 0;
            display: flex;
            height: 100vh;
            background: #0f172a;
            color: white;
            font-family: 'Segoe UI', sans-serif;
            overflow: hidden;
            user-select: none;
        }

        /* Side Shop Layout */
        .sidebar {
            width: var(--sidebar-w);
            background: rgba(0, 0, 0, 0.4);
            border-right: 2px solid #334155;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 10;
        }

        .main-game {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* IDLE ANIMATION */
        @keyframes idleBounce {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.02); }
        }

        @keyframes blink {
            0%, 90%, 100% { transform: scaleY(1); }
            95% { transform: scaleY(0.1); }
        }

        .ball-container {
            position: relative;
            width: 250px;
            height: 250px;
            cursor: pointer;
            animation: idleBounce 3s ease-in-out infinite; /* Idle movement */
            transition: transform 0.1s;
        }

        .ball-container:active {
            animation: none;
            transform: scale(0.9) rotate(3deg);
        }

        #country-flag {
            width: 100%; height: 100%;
            border-radius: 50%;
            border: 6px solid white;
            object-fit: cover;
        }

        .eyes {
            position: absolute; top: 35%; width: 100%;
            display: flex; justify-content: center; gap: 40px;
        }

        .eye {
            width: 35px; height: 45px;
            background: white; border-radius: 50%; border: 4px solid black;
            animation: blink 5s infinite; /* Idle blinking */
        }

        /* Save Slots */
        .save-slots { margin-top: auto; padding-top: 20px; border-top: 1px solid #334155; }
        .slot-btn {
            width: 100%; padding: 8px; margin-bottom: 5px;
            background: #334155; color: white; border: none; cursor: pointer;
        }
        .slot-btn.active { background: #27ae60; }

        /* UI elements */
        button {
            padding: 12px; border-radius: 8px; border: none;
            font-weight: bold; cursor: pointer; background: #27ae60; color: white;
        }
        button:disabled { background: #475569; cursor: not-allowed; }
        .stat-box { background: #1e293b; padding: 15px; border-radius: 10px; text-align: center; }
        .score-big { font-size: 3rem; font-weight: 900; margin: 10px 0; color: #f1c40f; }

        .click-popup {
            position: absolute; color: #f1c40f; font-weight: bold;
            pointer-events: none; animation: floatUp 0.6s ease-out forwards;
        }
        @keyframes floatUp {
            to { opacity: 0; transform: translateY(-100px); }
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <h3>UPGRADES</h3>
        <div class="stat-box">
            <div>Power: <span id="power-val">1</span></div>
            <br>
            <button id="buy-upgrade">Buy Power (Cost: 15)</button>
        </div>

        <div class="save-slots">
            <h4>SAVE SLOTS</h4>
            <button class="slot-btn active" onclick="switchSlot(1)" id="slot1">Slot 1</button>
            <button class="slot-btn" onclick="switchSlot(2)" id="slot2">Slot 2</button>
            <button class="slot-btn" onclick="switchSlot(3)" id="slot3">Slot 3</button>
        </div>
    </div>

    <div class="main-game">
        <h2 id="level-name">USA</h2>
        <div class="score-big" id="score-display">0</div>

        <div class="ball-container" id="ball">
            <img id="country-flag" src="https://flagpedia.net/data/flags/w580/us.png">
            <div class="eyes">
                <div class="eye"></div>
                <div class="eye"></div>
            </div>
        </div>
    </div>

    <script>
        let currentSlot = 1;
        let gameData = { score: 0, power: 1, upgradeCost: 15 };

        const countries = [
            { name: "USA", url: "https://flagpedia.net/data/flags/w580/us.png" },
            { name: "UK", url: "https://flagpedia.net/data/flags/w580/gb.png" },
            { name: "Japan", url: "https://flagpedia.net/data/flags/w580/jp.png" },
            { name: "Germany", url: "https://flagpedia.net/data/flags/w580/de.png" }
        ];

        function loadData() {
            const saved = localStorage.getItem(`countryball_slot_${currentSlot}`);
            gameData = saved ? JSON.parse(saved) : { score: 0, power: 1, upgradeCost: 15 };
            updateUI();
        }

        function saveData() {
            localStorage.setItem(`countryball_slot_${currentSlot}`, JSON.stringify(gameData));
        }

        function switchSlot(slotNum) {
            currentSlot = slotNum;
            document.querySelectorAll('.slot-btn').forEach((btn, i) => {
                btn.classList.toggle('active', (i + 1) === slotNum);
            });
            loadData();
        }

        function updateUI() {
            document.getElementById('score-display').textContent = Math.floor(gameData.score);
            document.getElementById('power-val').textContent = gameData.power;
            document.getElementById('buy-upgrade').innerText = `Upgrade Cost: ${gameData.upgradeCost}`;
            document.getElementById('buy-upgrade').disabled = gameData.score < gameData.upgradeCost;

            let lvl = Math.min(Math.floor(gameData.score / 100), countries.length - 1);
            document.getElementById('country-flag').src = countries[lvl].url;
            document.getElementById('level-name').textContent = countries[lvl].name;
        }

        document.getElementById('ball').addEventListener('click', (e) => {
            gameData.score += gameData.power;
            
            // Pop effect
            const p = document.createElement('div');
            p.className = 'click-popup';
            p.innerText = `+${gameData.power}`;
            p.style.left = e.clientX + 'px'; p.style.top = e.clientY + 'px';
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 600);

            updateUI();
            saveData();
        });

        document.getElementById('buy-upgrade').addEventListener('click', () => {
            if (gameData.score >= gameData.upgradeCost) {
                gameData.score -= gameData.upgradeCost;
                gameData.power++;
                gameData.upgradeCost = Math.round(gameData.upgradeCost * 1.7);
                updateUI();
                saveData();
            }
        });

        loadData();
    </script>
</body>
</html>
