<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Countryballs: Corrupted Realms</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --panel:#1e293b;
  --gold:#fbbf24;
  --green:#22c55e;
}
body {
  margin:0;
  height:100vh;
  display:flex;
  background: radial-gradient(circle at top, #020617, #000);
  font-family:Segoe UI, sans-serif;
  color:white;
  overflow:hidden;
}

/* Animated background */
#bg {
  position:fixed;
  inset:0;
  background:
    radial-gradient(circle at 20% 30%, rgba(0,255,255,0.08), transparent 40%),
    radial-gradient(circle at 80% 70%, rgba(255,0,0,0.08), transparent 40%);
  animation:bgMove 10s infinite alternate;
  z-index:-1;
}
@keyframes bgMove {
  from {filter:hue-rotate(0deg);}
  to {filter:hue-rotate(360deg);}
}

.sidebar {
  width:300px;
  background:rgba(0,0,0,0.8);
  border-right:3px solid #334155;
  padding:15px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.card {
  background:var(--panel);
  padding:12px;
  border-radius:10px;
  border:1px solid #475569;
}

button {
  width:100%;
  padding:10px;
  border:none;
  border-radius:6px;
  background:var(--green);
  color:white;
  font-weight:bold;
  cursor:pointer;
}

.main-game {
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}

/* Ball */
.ball-container {
  position:relative;
  width:260px;
  height:260px;
  cursor:pointer;
  animation:float 3s ease-in-out infinite;
}
@keyframes float {
  0%,100%{transform:translateY(0);}
  50%{transform:translateY(-12px);}
}

#country-flag {
  width:100%;
  height:100%;
  border-radius:50%;
  border:6px solid white;
  object-fit:cover;
  background:#222;
}

/* Eyes only, no pupils */
.eyes {
  position:absolute;
  top:35%;
  width:100%;
  display:flex;
  justify-content:center;
  gap:50px;
}
.eye {
  width:36px;
  height:46px;
  background:white;
  border-radius:50%;
  border:4px solid black;
}

/* EXTINCT visuals */
.extinct::after {
  content:"☠️";
  position:absolute;
  bottom:-20px;
  left:50%;
  transform:translateX(-50%);
  font-size:3rem;
  opacity:0.8;
}
.extinct .eye {
  background:#777;
}

/* CURSED visuals */
.cursed::before {
  content:"";
  position:absolute;
  width:100%;
  height:100%;
  border-radius:50%;
  background:
    radial-gradient(circle at 20% 80%, purple 10%, transparent 40%),
    radial-gradient(circle at 80% 20%, red 10%, transparent 40%);
  animation:tentacles 2s infinite alternate;
}
@keyframes tentacles {
  from{filter:blur(0);}
  to{filter:blur(4px);}
}
.cursed .eye {
  background:red;
  box-shadow:0 0 12px red;
}

/* Popup */
.popup {
  position:absolute;
  color:var(--gold);
  font-weight:bold;
  animation:pop 0.6s forwards;
  pointer-events:none;
}
@keyframes pop {
  to{opacity:0;transform:translateY(-80px) scale(1.8);}
}

/* Alt modes */
#alt-modes {
  position:fixed;
  top:10px;
  right:10px;
  display:flex;
  flex-direction:column;
  gap:6px;
  z-index:2000;
}
#alt-modes button {
  background:black;
  color:crimson;
  border:2px solid crimson;
  font-size:0.75rem;
}

/* Lore */
#lore-box {
  position:fixed;
  bottom:10px;
  left:10px;
  width:260px;
  font-size:0.8rem;
  opacity:0.85;
}
</style>
</head>

<body>
<div id="bg"></div>

<div id="alt-modes">
  <button onclick="enterExtinct()">PLAY EXTINCT</button>
  <button onclick="enterCursed()">PLAY CURSED</button>
</div>

<div class="sidebar">
  <h2 style="color:var(--gold)">Market</h2>
  <div class="card">
    <button id="buy-pwr">Power ($<span id="pwr-cost">15</span>)</button>
  </div>
  <div class="card">
    <button id="buy-auto">Auto ($<span id="auto-cost">100</span>)</button>
  </div>
  <div class="card">
    <button onclick="resetAll()" style="background:#ef4444">Reset</button>
  </div>
</div>

<div class="main-game">
  <div style="text-align:center;margin-bottom:20px">
    <div id="location-name" style="letter-spacing:4px;color:#64748b">START</div>
    <div id="score-val" style="font-size:4rem;color:var(--gold)">0</div>
    <div>Countrybux</div>
  </div>

  <div class="ball-container neutral" id="ball">
    <img id="country-flag">
    <div class="eyes">
      <div class="eye"></div>
      <div class="eye"></div>
    </div>
  </div>
</div>

<div id="lore-box" class="card">
  <strong>LORE</strong>
  <p id="lore-text">The world is unstable...</p>
</div>

<script>
let data={score:0,power:1,pwrCost:15,auto:0,autoCost:100};
const SAVE_KEY="cb_corrupt";
let extinctMode=false,cursedMode=false;

/* Milestone countries */
const milestones=[
  {score:0,code:"my"},
  {score:3000,code:"jp"},
  {score:6000,code:"de"},
  {score:9000,code:"eg"},
  {score:12000,code:"za"},
  {score:15000,code:"zw"}
];

function getCountryByMilestone(){
  let current=milestones[0].code;
  for(const m of milestones){
    if(data.score>=m.score) current=m.code;
  }
  return current;
}

function save(){localStorage.setItem(SAVE_KEY,JSON.stringify(data));}
function load(){
  const s=localStorage.getItem(SAVE_KEY);
  if(s) data=JSON.parse(s);
  refresh();
}

function refresh(){
  document.getElementById("score-val").textContent=Math.floor(data.score).toLocaleString();
  document.getElementById("pwr-cost").textContent=data.pwrCost;
  document.getElementById("auto-cost").textContent=data.autoCost;

  const code=getCountryByMilestone();
  const flag=document.getElementById("country-flag");
  flag.src=`https://flagcdn.com/w320/${code}.png`;
  flag.onerror=()=>flag.src="https://upload.wikimedia.org/wikipedia/commons/a/ac/No_image_available.svg";
  document.getElementById("location-name").textContent=code.toUpperCase();
  updateLore();
}

function spawnPopup(x,y,val){
  const p=document.createElement("div");
  p.className="popup";
  p.style.left=x+"px";
  p.style.top=y+"px";
  p.textContent="+"+val;
  document.body.appendChild(p);
  setTimeout(()=>p.remove(),600);
}

document.getElementById("ball").onclick=(e)=>{
  data.score+=data.power;
  spawnPopup(e.clientX,e.clientY,data.power);
  refresh(); save();
};

document.getElementById("buy-pwr").onclick=()=>{
  if(data.score>=data.pwrCost){
    data.score-=data.pwrCost;
    data.power++;
    data.pwrCost=Math.round(data.pwrCost*1.4);
    refresh(); save();
  }
};

document.getElementById("buy-auto").onclick=()=>{
  if(data.score>=data.autoCost){
    data.score-=data.autoCost;
    data.auto++;
    data.autoCost=Math.round(data.autoCost*1.6);
    refresh(); save();
  }
};

setInterval(()=>{
  if(data.auto>0){
    if(extinctMode) data.score+=Math.floor(data.auto*0.3);
    else if(cursedMode) data.score+=data.auto*(Math.random()<0.3?5:1);
    else data.score+=data.auto;
    refresh();
  }
},1000);

function enterExtinct(){
  extinctMode=true;cursedMode=false;
  document.getElementById("ball").className="ball-container extinct";
}

function enterCursed(){
  cursedMode=true;extinctMode=false;
  document.getElementById("ball").className="ball-container cursed";
}

function updateLore(){
  const lore=document.getElementById("lore-text");
  if(cursedMode) lore.textContent="Something ancient coils beneath the flags...";
  else if(extinctMode) lore.textContent="Only bones and echoes remain...";
  else if(data.score>14000) lore.textContent="Zimbabwe stands as the final realm.";
  else lore.textContent="The flags whisper as you grow stronger...";
}

function resetAll(){
  if(confirm("Reset everything?")){
    localStorage.removeItem(SAVE_KEY);
    location.reload();
  }
}

load();
</script>
</body>
</html>
