<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Click Countryballs</title>
    <style>
        :root { --panel: #1e293b; --bg: #0f172a; --accent: #3b82f6; }
        body {
            margin: 0; display: flex; height: 100vh;
            background: var(--bg); color: white;
            font-family: 'Segoe UI', sans-serif; overflow: hidden; user-select: none;
        }

        /* Sidebar UI */
        .sidebar {
            width: 280px; background: rgba(0,0,0,0.5);
            border-right: 3px solid #334155; padding: 20px;
            display: flex; flex-direction: column; gap: 15px;
        }

        .main-game {
            flex-grow: 1; display: flex; flex-direction: column;
            align-items: center; justify-content: center; position: relative;
        }

        /* Animations */
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        @keyframes blink { 0%, 90%, 100% { transform: scaleY(1); } 95% { transform: scaleY(0.1); } }

        /* The Ball */
        .ball-container {
            position: relative; width: 260px; height: 260px;
            animation: bounce 4s ease-in-out infinite;
            transition: transform 0.1s; cursor: pointer;
        }
        .ball-container:active { transform: scale(0.92); animation: none; }

        #country-flag {
            width: 100%; height: 100%; border-radius: 50%;
            border: 6px solid #fff; object-fit: cover;
            box-shadow: 0 10px 30px rgba(0,0,0,0.6);
        }

        /* Expressive Eyes */
        .eyes {
            position: absolute; top: 38%; width: 100%;
            display: flex; justify-content: center; gap: 40px;
        }
        .eye {
            width: 38px; height: 48px; background: white;
            border-radius: 50%; border: 4px solid #000;
            transition: all 0.2s; animation: blink 6s infinite;
        }

        /* Eye Moods */
        .eye.angry { transform: rotate(15deg); height: 30px; border-top: 8px solid black; }
        .eye.angry.right { transform: rotate(-15deg); }
        .eye.happy { border-bottom: 10px solid black; background: white; height: 35px; }

        /* Shop & Slots */
        .shop-item {
            background: var(--panel); padding: 12px; border-radius: 10px;
            border: 1px solid #475569; margin-bottom: 10px;
        }
        button {
            width: 100%; padding: 10px; border-radius: 5px; border: none;
            background: #22c55e; color: white; font-weight: bold; cursor: pointer;
        }
        button:disabled { background: #64748b; cursor: not-allowed; }
        
        .slot-area { margin-top: auto; border-top: 1px solid #334155; padding-top: 10px; }
        .slot-btn { background: #334155; margin-bottom: 5px; font-size: 0.8rem; }
        .slot-btn.active { background: #3b82f6; }

        .score-box { text-align: center; margin-bottom: 20px; }
        .score-num { font-size: 3.5rem; font-weight: 800; color: #fbbf24; }

        .popup {
            position: absolute; color: #fbbf24; font-weight: bold;
            pointer-events: none; animation: float 0.8s forwards;
        }
        @keyframes float { to { opacity: 0; transform: translateY(-100px); } }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2 style="margin:0">Market</h2>
        
        <div class="shop-item">
            <small>Click Power</small>
            <div id="pwr-lvl">Strength: 1</div>
            <button id="buy-pwr">Upgrade ($15)</button>
        </div>

        <div class="shop-item">
            <small>Auto-Clicker</small>
            <div id="auto-lvl">Workforce: 0</div>
            <button id="buy-auto">Hire ($50)</button>
        </div>

        <div class="slot-area">
            <small>SAVES</small>
            <button class="slot-btn active" onclick="changeSlot(1)" id="s1">Slot 1</button>
            <button class="slot-btn" onclick="changeSlot(2)" id="s2">Slot 2</button>
            <button class="slot-btn" onclick="changeSlot(3)" id="s3">Slot 3</button>
        </div>
    </div>

    <div class="main-game">
        <div class="score-box">
            <div id="location-name" style="letter-spacing: 3px; color: #94a3b8;">USA</div>
            <div class="score-num" id="total-score">0</div>
        </div>

        <div class="ball-container" id="ball">
            <img id="country-flag" src="https://flagpedia.net/data/flags/w580/us.png">
            <div class="eyes" id="eye-container">
                <div class="eye" id="l-eye"></div>
                <div class="eye right" id="r-eye"></div>
            </div>
        </div>
    </div>

    <script>
        let currentSlot = 1;
        let data = { score: 0, power: 1, pwrCost: 15, auto: 0, autoCost: 50 };

        const locations = [
            { name: "USA", url: "https://flagpedia.net/data/flags/w580/us.png" },
            { name: "Texas", url: "https://flagpedia.net/data/flags/w580/us-tx.png" },
            { name: "California", url: "https://flagpedia.net/data/flags/w580/us-ca.png" },
            { name: "France", url: "https://flagpedia.net/data/flags/w580/fr.png" },
            { name: "Italy", url: "https://flagpedia.net/data/flags/w580/it.png" },
            { name: "Poland", url: "https://flagpedia.net/data/flags/w580/pl.png" },
            { name: "Ukraine", url: "https://flagpedia.net/data/flags/w580/ua.png" },
            { name: "New York", url: "https://flagpedia.net/data/flags/w580/us-ny.png" }
        ];

        function save() { localStorage.setItem(`cb_save_${currentSlot}`, JSON.stringify(data)); }
        
        function changeSlot(n) {
            currentSlot = n;
            const saved = localStorage.getItem(`cb_save_${currentSlot}`);
            data = saved ? JSON.parse(saved) : { score: 0, power: 1, pwrCost: 15, auto: 0, autoCost: 50 };
            document.querySelectorAll('.slot-btn').forEach((b, i) => b.classList.toggle('active', (i+1)===n));
            refresh();
        }

        function setMood(mood) {
            const l = document.getElementById('l-eye');
            const r = document.getElementById('r-eye');
            l.className = r.className = 'eye';
            if(mood === 'happy') { l.classList.add('happy'); r.classList.add('happy'); }
            if(mood === 'angry') { l.classList.add('angry'); r.classList.add('angry'); r.classList.add('right'); }
        }

        function refresh() {
            document.getElementById('total-score').textContent = Math.floor(data.score);
            document.getElementById('pwr-lvl').textContent = `Strength: ${data.power}`;
            document.getElementById('buy-pwr').textContent = `Upgrade ($${data.pwrCost})`;
            document.getElementById('buy-pwr').disabled = data.score < data.pwrCost;
            
            document.getElementById('auto-lvl').textContent = `Workforce: ${data.auto}`;
            document.getElementById('buy-auto').textContent = `Hire ($${data.autoCost})`;
            document.getElementById('buy-auto').disabled = data.score < data.autoCost;

            let idx = Math.min(Math.floor(data.score / 100), locations.length - 1);
            document.getElementById('country-flag').src = locations[idx].url;
            document.getElementById('location-name').textContent = locations[idx].name;
        }

        document.getElementById('ball').addEventListener('click', (e) => {
            data.score += data.power;
            setMood('happy');
            setTimeout(() => setMood('neutral'), 300);
            
            const p = document.createElement('div');
            p.className = 'popup';
            p.style.left = e.clientX + 'px'; p.style.top = e.clientY + 'px';
            p.innerText = `+${data.power}`;
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 800);
            
            refresh(); save();
        });

        document.getElementById('buy-pwr').addEventListener('click', () => {
            if(data.score >= data.pwrCost) {
                data.score -= data.pwrCost;
                data.power++;
                data.pwrCost = Math.round(data.pwrCost * 1.8);
                refresh(); save();
            }
        });

        document.getElementById('buy-auto').addEventListener('click', () => {
            if(data.score >= data.autoCost) {
                data.score -= data.autoCost;
                data.auto++;
                data.autoCost = Math.round(data.autoCost * 2.1);
                refresh(); save();
            }
        });

        setInterval(() => {
            if(data.auto > 0) {
                data.score += (data.auto * 0.2);
                refresh();
            }
        }, 1000);

        changeSlot(1);
    </script>
</body>
</html>
